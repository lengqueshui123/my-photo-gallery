<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¥ç§˜å¯»å®å¤§å†’é™©</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            color: #ffd700;
        }

        .game-area {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .map-container {
            position: relative;
            height: 300px;
            background: #2c3e50;
            border-radius: 10px;
            overflow: hidden;
            border: 3px solid #34495e;
        }

        .location {
            position: absolute;
            width: 60px;
            height: 60px;
            background: #e74c3c;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(231, 76, 60, 0.5);
        }

        .location.active {
            background: #f39c12;
            transform: scale(1.2);
            box-shadow: 0 0 30px rgba(243, 156, 18, 0.8);
        }

        .location.found {
            background: #27ae60;
            box-shadow: 0 0 25px rgba(39, 174, 96, 0.7);
        }

        .library { top: 50px; left: 100px; }
        .temple { top: 150px; left: 400px; }
        .cave { top: 80px; left: 600px; }
        .castle { top: 200px; left: 250px; }

        .controls {
            text-align: center;
            margin: 20px 0;
        }

        button {
            background: linear-gradient(45deg, #e67e22, #d35400);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 0 10px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        button:disabled {
            background: #7f8c8d;
            cursor: not-allowed;
            transform: none;
        }

        .log {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
        }

        .log-entry {
            margin: 10px 0;
            padding: 10px;
            border-left: 3px solid #3498db;
            background: rgba(255, 255, 255, 0.05);
        }

        .log-entry.success {
            border-left-color: #27ae60;
            color: #2ecc71;
        }

        .log-entry.error {
            border-left-color: #e74c3c;
            color: #e74c3c;
        }

        .treasure {
            text-align: center;
            font-size: 24px;
            color: #ffd700;
            margin: 20px 0;
            opacity: 0;
            transition: opacity 1s ease;
        }

        .treasure.revealed {
            opacity: 1;
        }

        .progress-bar {
            height: 10px;
            background: #34495e;
            border-radius: 5px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            width: 0%;
            transition: width 0.5s ease;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .pulse {
            animation: pulse 1s infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ´â€â˜ ï¸ ç¥ç§˜å¯»å®å¤§å†’é™© ğŸ—ºï¸</h1>
        
        <div class="game-area">
            <div class="map-container">
                <div class="location library" title="å¤è€å›¾ä¹¦é¦†">ğŸ“š</div>
                <div class="location temple" title="ç¥ç§˜ç¥åº™">ğŸ›ï¸</div>
                <div class="location cave" title="é»‘æš—æ´ç©´">ğŸ•³ï¸</div>
                <div class="location castle" title="åºŸå¼ƒåŸå ¡">ğŸ°</div>
            </div>

            <div class="progress-bar">
                <div class="progress" id="progress"></div>
            </div>

            <div class="controls">
                <button onclick="startAdventure()">å¼€å§‹å¯»å®å†’é™©</button>
                <button onclick="resetGame()" id="resetBtn" disabled>é‡æ–°å¼€å§‹</button>
            </div>

            <div class="treasure" id="treasureMessage"></div>

            <div class="log" id="gameLog"></div>
        </div>
    </div>

    <script>
        // æ‰©å±•çš„å®è—åœ°å›¾API
        class TreasureMap {
            static async getInitialClue() {
                await delay(1000);
                return "åœ¨å¤è€çš„å›¾ä¹¦é¦†é‡Œæ‰¾åˆ°äº†ç¬¬ä¸€ä¸ªçº¿ç´¢ï¼šä¸€å¼ ç¥ç§˜çš„åœ°å›¾...";
            }

            static async decodeAncientScript(clue) {
                if (!clue) {
                    throw new Error("æ²¡æœ‰çº¿ç´¢å¯ä»¥è§£ç !");
                }
                await delay(1500);
                return "è§£ç æˆåŠŸ!åœ°å›¾æ˜¾ç¤ºå®è—åœ¨ä¸€åº§ç¥ç§˜çš„ç¥åº™ä¸­ï¼Œä½†éœ€è¦å…ˆæ‰¾åˆ°ç¥åº™é’¥åŒ™...";
            }

            static async findTempleKey() {
                await delay(1200);
                const success = Math.random() > 0.3;
                if (!success) {
                    throw new Error("åœ¨é»‘æš—æ´ç©´ä¸­å¯»æ‰¾é’¥åŒ™æ—¶é‡åˆ°äº†è™è ç¾¤!");
                }
                return "åœ¨é»‘æš—æ´ç©´æ·±å¤„æ‰¾åˆ°äº†å¤è€çš„ç¥åº™é’¥åŒ™!";
            }

            static async searchTemple(location, hasKey) {
                if (!hasKey) {
                    throw new Error("æ²¡æœ‰é’¥åŒ™æ— æ³•è¿›å…¥ç¥åº™!");
                }
                
                await delay(2000);
                const success = Math.random() > 0.4;
                if (!success) {
                    throw new Error("ç³Ÿç³•!é‡åˆ°äº†ç¥åº™å®ˆå«ï¼Œéœ€è¦æ™ºå–!");
                }
                return "æˆåŠŸè¿›å…¥ç¥åº™!æ‰¾åˆ°äº†ä¸€ä¸ªé•¶åµŒå®çŸ³çš„ç¥ç§˜ç®±å­...";
            }

            static async solvePuzzle() {
                await delay(1800);
                const success = Math.random() > 0.25;
                if (!success) {
                    throw new Error("ç®±å­çš„æœºå…³å¤ªå¤æ‚äº†ï¼Œéœ€è¦æ›´å¤šæ—¶é—´ç ”ç©¶!");
                }
                return "æˆåŠŸè§£å¼€ç®±å­çš„å¤è€æœºå…³!";
            }

            static async openTreasureBox() {
                await delay(1000);
                return "ğŸ‰ æ­å–œ!ä½ æ‰¾åˆ°äº†ä¼ è¯´ä¸­çš„é»„é‡‘å®è—å’Œå¤±è½çš„ç‹å† ! ğŸ†";
            }

            static async exploreCastle() {
                await delay(1500);
                return "åœ¨åºŸå¼ƒåŸå ¡ä¸­å‘ç°äº†é¢å¤–çš„å®çŸ³å’Œå¤è€é‡‘å¸! ğŸ’";
            }
        }

        // å·¥å…·å‡½æ•°
        function delay(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function addLog(message, type = 'info') {
            const log = document.getElementById('gameLog');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function updateProgress(step, totalSteps) {
            const progress = document.getElementById('progress');
            const percentage = (step / totalSteps) * 100;
            progress.style.width = percentage + '%';
        }

        function highlightLocation(locationClass) {
            // ç§»é™¤æ‰€æœ‰é«˜äº®
            document.querySelectorAll('.location').forEach(loc => {
                loc.classList.remove('active');
            });
            
            // é«˜äº®å½“å‰ä½ç½®
            const location = document.querySelector(`.${locationClass}`);
            if (location) {
                location.classList.add('active', 'pulse');
                setTimeout(() => location.classList.remove('pulse'), 1000);
            }
        }

        function markLocationFound(locationClass) {
            const location = document.querySelector(`.${locationClass}`);
            if (location) {
                location.classList.add('found');
            }
        }

        // ä¸»è¦çš„å¯»å®å†’é™©å‡½æ•°
        async function findTreasureWithAsyncAwait() {
            const totalSteps = 6;
            let currentStep = 0;
            
            try {
                // æ­¥éª¤1: è·å–åˆå§‹çº¿ç´¢
                highlightLocation('library');
                addLog("å¼€å§‹å¯»å®å†’é™©...", "success");
                updateProgress(++currentStep, totalSteps);
                
                const clue = await TreasureMap.getInitialClue();
                addLog(clue, "success");
                markLocationFound('library');

                // æ­¥éª¤2: è§£ç å¤è€æ–‡å­—
                updateProgress(++currentStep, totalSteps);
                const location = await TreasureMap.decodeAncientScript(clue);
                addLog(location, "success");

                // æ­¥éª¤3: å¯»æ‰¾ç¥åº™é’¥åŒ™
                highlightLocation('cave');
                updateProgress(++currentStep, totalSteps);
                const key = await TreasureMap.findTempleKey();
                addLog(key, "success");
                markLocationFound('cave');

                // æ­¥éª¤4: æœç´¢ç¥åº™
                highlightLocation('temple');
                updateProgress(++currentStep, totalSteps);
                const box = await TreasureMap.searchTemple(location, true);
                addLog(box, "success");
                markLocationFound('temple');

                // æ­¥éª¤5: è§£å¼€è°œé¢˜
                updateProgress(++currentStep, totalSteps);
                const puzzle = await TreasureMap.solvePuzzle();
                addLog(puzzle, "success");

                // æ­¥éª¤6: æ‰“å¼€å®è—ç®±
                updateProgress(++currentStep, totalSteps);
                const treasure = await TreasureMap.openTreasureBox();
                
                // é¢å¤–å¥–åŠ±: æ¢ç´¢åŸå ¡
                highlightLocation('castle');
                const bonus = await TreasureMap.exploreCastle();
                addLog(bonus, "success");
                markLocationFound('castle');

                // æ˜¾ç¤ºæœ€ç»ˆå®è—
                const treasureMessage = document.getElementById('treasureMessage');
                treasureMessage.textContent = treasure;
                treasureMessage.classList.add('revealed');
                
                addLog("ğŸŠ å¯»å®å†’é™©åœ†æ»¡å®Œæˆ! ä½ æˆä¸ºäº†ä¼ å¥‡æ¢é™©å®¶!", "success");

            } catch (error) {
                addLog(`å†’é™©é‡åˆ°é˜»ç¢: ${error}`, "error");
                addLog("ä¸è¦æ”¾å¼ƒ! ç‚¹å‡»é‡æ–°å¼€å§‹æŒ‰é’®å†æ¬¡å°è¯•!", "info");
            } finally {
                document.getElementById('resetBtn').disabled = false;
            }
        }

        // æ¸¸æˆæ§åˆ¶å‡½æ•°
        function startAdventure() {
            const startBtn = document.querySelector('button');
            startBtn.disabled = true;
            
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            document.getElementById('gameLog').innerHTML = '';
            document.getElementById('treasureMessage').classList.remove('revealed');
            document.getElementById('treasureMessage').textContent = '';
            document.getElementById('progress').style.width = '0%';
            
            // é‡ç½®ä½ç½®æ ‡è®°
            document.querySelectorAll('.location').forEach(loc => {
                loc.classList.remove('found', 'active');
            });
            
            findTreasureWithAsyncAwait();
        }

        function resetGame() {
            document.getElementById('resetBtn').disabled = true;
            const startBtn = document.querySelector('button');
            startBtn.disabled = false;
            
            // æ¸…é™¤æ—¥å¿—å’ŒçŠ¶æ€
            document.getElementById('gameLog').innerHTML = '';
            document.getElementById('treasureMessage').classList.remove('revealed');
            document.getElementById('treasureMessage').textContent = '';
            document.getElementById('progress').style.width = '0%';
            
            // é‡ç½®ä½ç½®æ ‡è®°
            document.querySelectorAll('.location').forEach(loc => {
                loc.classList.remove('found', 'active');
            });
        }

        // åˆå§‹åŒ–æ¸¸æˆè¯´æ˜
        addLog("æ¬¢è¿æ¥åˆ°ç¥ç§˜å¯»å®å¤§å†’é™©!", "success");
        addLog("ç‚¹å‡»'å¼€å§‹å¯»å®å†’é™©'æŒ‰é’®å¼€å§‹ä½ çš„æ—…ç¨‹...", "info");
        addLog("æ³¨æ„: æ¯æ¬¡å†’é™©éƒ½ä¼šæœ‰ä¸åŒçš„éšæœºäº‹ä»¶å‘ç”Ÿ!", "info");
    </script>
</body>
</html>